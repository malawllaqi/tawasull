version: '3.9'

services:
  api:
    build:
      context: .
      dockerfile: ./apps/api/Dockerfile
    container_name: tawasull-api
    restart: unless-stopped
    ports:
      - 3000:3000
    volumes:
      # Mount entire monorepo to preserve workspace structure
      - .:/app
      # Preserve node_modules at root level (workspace hoisting)
      - /app/node_modules
      # Preserve api-specific node_modules
      - /app/apps/api/node_modules
    working_dir: /app/apps/api
    command: pnpm dev